This is originally developped by Xiaolei Niu!